# HTE Product Page Widget

Виджет для отображения страницы продукта с расширенной функциональностью выбора вариантов, опций и персонализации.

## Функциональность

### 1. Выбор вариантов товара
- Отображение всех доступных вариантов товара
- Переключение между вариантами с обновлением цены
- Визуальное выделение активного варианта

### 2. Навигация по дням меню
- Переключение между днями (1-30)
- Отображение текущего дня
- Блокировка кнопок на границах диапазона

### 3. Выбор калорийности
- Три варианта: 2300, 2500, 3000 ккал
- Автоматическое обновление информации о питательности
- Визуальный индикатор активного выбора

### 4. Выбор типа питания
- Классика
- Вегетарианство
- Пескетарианство
- Веганство

### 5. Исключение приемов пищи
- Переключатели для исключения завтрака/перекуса
- Переключатели для исключения ужина/перекуса
- Автоматический пересчет цены

### 6. Исключение аллергенов
- Выпадающий список с поиском
- Первые 3 аллергена бесплатно
- Дополнительные аллергены +300 ₽
- Отображение выбранных аллергенов в виде тегов
- Возможность удаления аллергенов

### 7. Динамический расчет цены
- Базовая цена товара
- Доплата за аллергены (после 3-го)
- Скидка за исключенные приемы пищи
- Обновление в реальном времени

### 8. Добавление в корзину
- Сбор всех выбранных опций
- Формирование свойств товара
- Уведомление об успешном добавлении

## Структура файлов

```
HTE Product Page/
├── snippet.liquid      # HTML шаблон
├── snippet.js          # JavaScript функциональность
├── snippet.scss        # Стили
├── example-data.json   # Пример данных
├── README.md          # Документация
└── info.json          # Метаданные виджета
```

## Использование

### 1. Подключение виджета
Добавьте виджет на страницу товара через админ-панель Insales.

### 2. Настройка данных
Данные о товаре автоматически загружаются из Insales API:
- Информация о товаре
- Варианты товара
- Цены и доступность

### 3. Кастомизация
Для изменения функциональности отредактируйте файлы:
- `snippet.liquid` - структура HTML
- `snippet.js` - логика JavaScript
- `snippet.scss` - стили

## API и события

### JavaScript API

```javascript
// Инициализация виджета
const widget = new ProductPageWidget();

// Получение текущих настроек
const settings = {
    variant: widget.currentVariant,
    calories: widget.currentCalories,
    diet: widget.currentDiet,
    allergens: widget.selectedAllergens,
    excludedMeals: widget.excludedMeals
};
```

### События

- `variantChange` - изменение варианта товара
- `calorieChange` - изменение калорийности
- `dietChange` - изменение типа питания
- `allergenChange` - изменение аллергенов
- `mealToggle` - переключение приемов пищи
- `addToCart` - добавление в корзину

## Стилизация

### CSS переменные
Виджет использует CSS переменные для единообразного стиля:

```scss
:root {
    --hte-black: #000000;
    --hte-white: #ffffff;
    --hte-border: #e0e0e0;
    --hte-dark-accent: #f5f5f5;
    --spacing-10: 10px;
    --border-radius-xl: 12px;
    // ... и другие
}
```

### Адаптивность
Виджет адаптируется под различные размеры экранов:
- Desktop: полная функциональность
- Tablet: упрощенная навигация
- Mobile: вертикальное расположение элементов

## Интеграция с Insales

### Данные товара
```liquid
{{ product.title }}           # Название товара
{{ product.description }}     # Описание
{{ product.variants }}        # Варианты товара
{{ product.price }}           # Цена
```

### Корзина
```javascript
// Добавление в корзину с свойствами
const cartData = {
    productId: variant.id,
    quantity: 1,
    properties: {
        'Калорийность': '2300 ккал',
        'Тип питания': 'Классика',
        'Исключенные аллергены': 'Глютен, Лактоза'
    }
};
```

## Примеры использования

### 1. Базовое использование
Просто добавьте виджет на страницу товара - он автоматически загрузит данные и настроит функциональность.

### 2. Кастомизация стилей
```scss
// Изменение цветов
.variant-option.active {
    background-color: #your-color;
    border-color: #your-color;
}

// Изменение размеров
.calorie-option {
    padding: 15px 25px;
    font-size: 16px;
}
```

### 3. Добавление новой функциональности
```javascript
// Добавление нового обработчика
widget.on('customEvent', (data) => {
    console.log('Custom event:', data);
});

// Расширение класса
class CustomProductWidget extends ProductPageWidget {
    constructor() {
        super();
        this.initCustomFeatures();
    }
    
    initCustomFeatures() {
        // Ваша логика
    }
}
```

## Поддержка

Для получения поддержки или внесения изменений:
1. Проверьте консоль браузера на наличие ошибок
2. Убедитесь, что все зависимости загружены
3. Проверьте корректность данных товара в Insales

## Версии

- v1.0.0 - Базовая функциональность
- v1.1.0 - Добавлена поддержка аллергенов
- v1.2.0 - Улучшена адаптивность
- v1.3.0 - Добавлен динамический расчет цены 